(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[276],{1177:function(e,r,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/history",function(){return n(283)}])},3300:function(e,r,n){"use strict";var t=n(5666),i=n.n(t),o=n(813),c=n(7294),s=n(980),u=n(1529),a=n(6064),l=n(2804);function d(e,r,n,t,i,o,c){try{var s=e[o](c),u=s.value}catch(a){return void n(a)}s.done?r(u):Promise.resolve(u).then(t,i)}function f(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var n=[],t=!0,i=!1,o=void 0;try{for(var c,s=e[Symbol.iterator]();!(t=(c=s.next()).done)&&(n.push(c.value),!r||n.length!==r);t=!0);}catch(u){i=!0,o=u}finally{try{t||null==s.return||s.return()}finally{if(i)throw o}}return n}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}r.Z=function(){var e,r=new o.DB("log"),n=f(c.useState(!1),2),t=n[0],h=n[1],m=(0,s.useToast)(),x=new u.Z,p=(0,l.Zl)(a.K5),v=(0,l.Zl)(a.eY),g=(e=i().mark((function e(n,t){var o,c,s,u,a,l,d,f,h,m,p,v,g,j,y,b;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.openDB();case 2:return e.next=4,x.getLogs(n,t);case 4:return o=e.sent,e.next=7,r.getAll();case 7:for(c=e.sent,s=[],u=[],a=!0,l=!1,d=void 0,e.prev=11,f=c[Symbol.iterator]();!(a=(h=f.next()).done);a=!0)m=h.value,o.find((function(e){return e.code===m.code}))||o.find((function(e){return e.date===m.date}))||u.push(m);e.next=19;break;case 15:e.prev=15,e.t0=e.catch(11),l=!0,d=e.t0;case 19:e.prev=19,e.prev=20,a||null==f.return||f.return();case 22:if(e.prev=22,!l){e.next=25;break}throw d;case 25:return e.finish(22);case 26:return e.finish(19);case 27:for(p=!0,v=!1,g=void 0,e.prev=28,j=o[Symbol.iterator]();!(p=(y=j.next()).done);p=!0)b=y.value,c.find((function(e){return e.code===b.code}))||c.find((function(e){return e.date===b.date}))||s.push(b);e.next=36;break;case 32:e.prev=32,e.t1=e.catch(28),v=!0,g=e.t1;case 36:e.prev=36,e.prev=37,p||null==j.return||j.return();case 39:if(e.prev=39,!v){e.next=42;break}throw g;case 42:return e.finish(39);case 43:return e.finish(36);case 44:return e.next=46,r.addMulti(s);case 46:return e.next=48,x.addLog(n,u,t);case 48:case"end":return e.stop()}}),e,null,[[11,15,19,27],[20,,22,26],[28,32,36,44],[37,,39,43]])})),function(){var r=this,n=arguments;return new Promise((function(t,i){var o=e.apply(r,n);function c(e){d(o,t,i,c,s,"next",e)}function s(e){d(o,t,i,c,s,"throw",e)}c(void 0)}))});return[t,function(e){g(e,(function(){p(!1),v(null)})).then((function(){h(!0)})).catch((function(){m({title:"\u30af\u30e9\u30a6\u30c9\u3068\u540c\u671f\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f",description:"\u8a2d\u5b9a\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044",status:"error"})}))}]}},283:function(e,r,n){"use strict";n.r(r),n.d(r,{default:function(){return M}});var t=n(5893),i=n(8017),o=n(5666),c=n.n(o),s=n(7294),u=n(980),a=n(4860),l=n(8448),d=n(7389),f=n(6729),h=n(5665),m=n(6618),x=n(4115),p=n(1614),v=n(4003),g=n(993),j=n(3346),y=n(4096),b=n(2804),w=n(6064),C=n(8862),k=n(3692),O=n(9521),S=n(155),P=n(2083),T=n(6040),A=n(4855),E=n(7799),N=function(e){var r=e.isChecked,n=e.setIsChecked,i=e.text,o=e.id;return(0,t.jsxs)(f.NI,{display:"flex",alignItems:"center",margin:".5rem .2rem .5rem .2rem",children:[(0,t.jsx)(h.r,{isChecked:r,onChange:function(e){n(e.target.checked)},id:o,size:"lg"}),(0,t.jsx)(m.l,{htmlFor:o,mb:"0",marginLeft:"1rem",fontSize:"1.2em",fontWeight:"bold",children:i})]})},_=n(813),z=n(3300);function F(e,r,n,t,i,o,c){try{var s=e[o](c),u=s.value}catch(a){return void n(a)}s.done?r(u):Promise.resolve(u).then(t,i)}function I(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function B(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{},t=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),t.forEach((function(r){I(e,r,n[r])}))}return e}function V(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var n=[],t=!0,i=!1,o=void 0;try{for(var c,s=e[Symbol.iterator]();!(t=(c=s.next()).done)&&(n.push(c.value),!r||n.length!==r);t=!0);}catch(u){i=!0,o=u}finally{try{t||null==s.return||s.return()}finally{if(i)throw o}}return n}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Z(e){return function(e){if(Array.isArray(e)){for(var r=0,n=new Array(e.length);r<e.length;r++)n[r]=e[r];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var D=function(){var e=V((0,b.FV)(w.Ob),2),r=e[0],n=e[1],o=V((0,b.FV)(w.ZW),2),I=o[0],D=o[1],M=V((0,b.FV)(w.FJ),2),W=M[0],R=M[1],H=V((0,b.FV)(w.AZ),2),L=H[0],q=H[1],J=V((0,b.FV)(w.s$),2),K=J[0],X=J[1],G=V((0,b.FV)(w.gB),2),U=G[0],Y=G[1],$=V((0,b.FV)(w.ZT),2),Q=$[0],ee=$[1],re=V((0,b.FV)(w.hK),2),ne=re[0],te=re[1],ie=(0,a.q)(),oe=ie.isOpen,ce=ie.onOpen,se=ie.onClose,ue=(0,u.useToast)(),ae=V((0,z.Z)(),2),le=ae[0],de=ae[1],fe=(0,b.sJ)(w.eY),he=(0,b.sJ)(w.K5);s.useEffect((function(){he&&de(fe.id)}),[]),s.useEffect((function(){var e;(e=c().mark((function e(){var r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new _.DB("log"),e.next=3,r.openDB();case 3:return e.t0=n,e.next=6,r.getPeriod(K);case 6:return e.t1=e.sent,(0,e.t0)(e.t1),e.t2=D,e.next=11,r.count();case 11:e.t3=e.sent,(0,e.t2)(e.t3);case 13:case"end":return e.stop()}}),e)})),function(){var r=this,n=arguments;return new Promise((function(t,i){var o=e.apply(r,n);function c(e){F(o,t,i,c,s,"next",e)}function s(e){F(o,t,i,c,s,"throw",e)}c(void 0)}))})()}),[K,le]);var me=s.useMemo((function(){return Z(r).reverse().map((function(e){var r=new C.E(e);return r.isUseLog()?r.historyTableText(Q,ne):{date:"Null",building:0,floor:0,room:"Null",seat:"Null",campus:"Null"}}))}),[r,Q,ne]),xe=s.useMemo((function(){return T.h4.map((function(e){return{Header:e.name,accessor:e.id}}))}),[]),pe=(0,O.useTable)({columns:xe,data:me,initialState:{hiddenColumns:(0,k.qr)(T.CA)}},O.useSortBy),ve=pe.getTableProps,ge=pe.getTableBodyProps,je=pe.headerGroups,ye=pe.rows,be=pe.prepareRow,we=pe.setHiddenColumns;s.useEffect((function(){we((0,k.qr)(W))}),[W]);var Ce=function(e){return(0,t.jsx)(l.M,{margin:"1rem",children:(0,t.jsx)(d.z,B({borderRadius:"1.5rem",width:"20rem",backgroundColor:(0,P.O)("buttonSecondly"),padding:"1rem .5rem 1rem .5rem"},e,{children:e.children}))})};return s.useEffect((function(){L&&ue({title:"".concat((0,k.PN)(U),"\u3092\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f"),status:"success",duration:4e3,isClosable:!0}),q(!1)}),[L]),(0,t.jsxs)(E.h,{title:"\u5c65\u6b74",children:[(0,t.jsx)(Ce,{onClick:ce,children:(0,t.jsx)(x.x,{color:(0,P.O)("textPrimary"),children:"\u30d5\u30a3\u30eb\u30bf\u30fc"})}),(0,t.jsx)(A.CopyToClipboard,{onCopy:function(){return q(!0)},text:(0,k.JT)(r),children:(0,t.jsx)(Ce,{children:(0,t.jsx)(x.x,{color:(0,P.O)("textPrimary"),children:"\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc"})})}),(0,t.jsxs)(p.u_,{isOpen:oe,onClose:se,size:"sm",isCentered:!0,children:[(0,t.jsx)(p.ZA,{}),(0,t.jsxs)(p.hz,{children:[(0,t.jsx)(p.xB,{children:"\u30d5\u30a3\u30eb\u30bf\u30fc"}),(0,t.jsx)(p.ol,{size:"lg"}),(0,t.jsxs)(p.fe,{padding:"1rem 2rem 1rem 2rem",children:[(0,t.jsx)(i.xu,{children:T.h4.map((function(e,r){return(0,t.jsxs)(f.NI,{display:"flex",alignItems:"center",margin:".5rem .2rem .5rem .2rem",children:[(0,t.jsx)(h.r,{isChecked:W[r],onChange:function(e){var n=Z(W);n[r]=e.target.checked,R(n)},size:"lg",id:"switch-".concat(r)}),(0,t.jsx)(m.l,{htmlFor:"switch-".concat(r),marginLeft:"1rem",mb:"0",fontSize:"1.2em",fontWeight:"bold",children:e.name})]},r)}))}),(0,t.jsx)(v.i,{colorScheme:(0,P.O)("divider"),borderWidth:"1px"}),(0,t.jsx)(N,{isChecked:Q,setIsChecked:ee,text:"\u77ed\u3044\u65e5\u6642",id:"shortDate"}),(0,t.jsx)(N,{isChecked:ne,setIsChecked:te,text:"\u7279\u6b8a\u306a\u90e8\u5c4b\u540d",id:"uniqueRoom"}),(0,t.jsx)(l.M,{margin:"1rem 0 .5rem 0",children:(0,t.jsxs)(x.x,{fontWeight:"bold",children:["\u8868\u793a\u30ed\u30b0: ",(0,k.PN)(U)," / \u5408\u8a08\u30ed\u30b0\u6570: ",I]})}),(0,t.jsxs)(g.iR,{defaultValue:K,min:1,max:T.zk,step:0,onChange:function(e){Y(e)},onChangeEnd:function(e){X(e)},isReadOnly:!1,isDisabled:!1,children:[(0,t.jsxs)(g.Uj,{children:[(0,t.jsx)(i.xu,{position:"relative",right:10}),(0,t.jsx)(g.Ms,{})]}),(0,t.jsx)(g.gs,{boxSize:6})]})]})]})]}),(0,t.jsx)(l.M,{marginTop:"2rem",children:(0,t.jsxs)(j.iA,B({},ve(),{display:"block",variant:"striped",colorScheme:"gray",size:"md",overflowX:"scroll",whiteSpace:"nowrap",style:{WebkitOverflowScrolling:"touch"},children:[(0,t.jsx)(j.hr,{children:je.map((function(e){return(0,t.jsx)(j.Tr,B({},e.getHeaderGroupProps(),{children:e.headers.map((function(e){return(0,t.jsx)(j.Th,B({},e.getHeaderProps(e.getSortByToggleProps()),{padding:".5rem .1rem .5rem .1rem",backgroundColor:(0,P.O)("mainSecondly"),color:(0,P.O)("textTertiary"),fontSize:"1.2rem",children:(0,t.jsx)(l.M,{children:(0,t.jsxs)(y.k,{children:[(0,t.jsx)(x.x,{children:e.render("Header")}),(0,t.jsx)(x.x,{children:e.isSorted?e.isSortedDesc?(0,t.jsx)(S.uiN,{}):(0,t.jsx)(S.xW6,{}):null})]})})}))}))}))}))}),(0,t.jsx)(j.p3,B({},ge(),{children:ye.map((function(e){return be(e),(0,t.jsx)(j.Tr,B({},e.getRowProps(),{children:e.cells.map((function(e){return(0,t.jsx)(j.Td,B({},e.getCellProps(),{textAlign:"center",children:e.render("Cell")}))}))}))}))}))]}))})]})},M=function(){return(0,t.jsx)(i.xu,{margin:"2.3rem .1rem 1rem .1rem",children:(0,t.jsx)(D,{})})}}},function(e){e.O(0,[260,559,666,851,880,585,697,774,888,179],(function(){return r=1177,e(e.s=r);var r}));var r=e.O();_N_E=r}]);